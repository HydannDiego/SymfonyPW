{% extends 'base.html.twig' %}

{% block title %}Statistiques du site{% endblock %}

{% block body %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <div class="p-1">
         STATISTIQUE #1 : Nombre de biens par catégorie
        <div class="grid grid-flow-col mb-8">
            <div class="chart-container p-5" style="height:40vh; width:40vw">
                <canvas id="chart"></canvas>
                <script>
                    const ctx = document.getElementById('chart').getContext('2d');
                    const chart = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: [
                                {% for cat in categories %}
                                '{{ cat.intitule }}',
                                {% endfor %}
                            ],
                            datasets: [{
                                label: 'Nombre de biens par catégorie',
                                data: [
                                    {% for i in 0..countSorted|length-1 %}
                                    {{ countSorted[i]["nombre"] }},
                                    {% endfor %}
                                ],
                            }],
                        },
                        options: {
                            responsive: true
                        }
                    });
                </script>
                <h1 class="content-center justify-items-center font-bold rounded-lg border shadow-lg">STATISTIQUE #1 :</h1>
                <p class="content-center">Nombre de biens par catégorie</p>
            </div>
        </div>
         STATISTIQUE #2 : Nombre de favoris créés au mois
        <div class="grid grid-flow-col mb-8">
            <div class="chart-container p-5" style="height:40vh; width:40vw">
                <canvas id="chart2"></canvas>
                <script>
                    {% set months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'] %}
                    const ctx2 = document.getElementById('chart2').getContext('2d');
                    const data2 = {
                        labels: {{ months|json_encode|raw }},
                        datasets: [{
                            label: 'Nombre de favoris créés au mois',
                            data: {
                                {% for month in months %}
                                '{{ month }}': 0,
                                {% endfor %}
                            },
                            fill: false,
                            borderColor: 'red',
                            tension: 0.1
                        }]
                    };
                    const chart2 = new Chart(ctx2, {
                        type: 'line',
                        data: data2,
                        options: {
                            responsive: true
                        }
                    });
                </script>
                <h1 class="content-center justify-items-center font-bold rounded-lg border shadow-lg">STATISTIQUE #2 :</h1>
                <p class="content-center">Nombre de favoris créés au mois</p>
            </div>
        </div>
         STATISTIQUE #3 : Les 3 biens les plus mis en favoris
        <div class="grid grid-flow-col mb-8">
            <div class="chart-container p-5" style="height:40vh; width:40vw">
                <canvas id="chart3"></canvas>
                <script>
                    const ctx3 = document.getElementById('chart3').getContext('2d');
                    const chart3 = new Chart(ctx3, {
                        type: 'line',
                        data: {
                            labels: [
                                {% for cat in categories %}
                                '{{ cat.intitule }}',
                                {% endfor %}
                            ],
                            datasets: [{
                                label: 'Les 3 biens les plus mis en favoris',
                                data: [
                                ],
                            }],
                        },
                        options: {
                            responsive: true
                        }
                    });
                </script>
                <h1 class="content-center justify-items-center font-bold rounded-lg border shadow-lg">STATISTIQUE #3 :</h1>
                <p class="content-center">Les 3 biens les plus mis en favoris</p>
            </div>
        </div>
    </div>
{% endblock %}
